"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[7885],{17885:(e,t,a)=>{a.r(t),a.d(t,{RunPrint:()=>u});var r,n=a(68230),i=a(3091),o=a(47130),l=a(27387),s=a(34545),c=a(76780),p=a(69621),m=a(94981);let u=r=class{async execute(e,t,a,r){var n=l.U.string("url",e.url,l.U.never),o=l.U.number("scale",e.scale,void 0),s=l.U.string("resultFileName",e.resultFileName,"Print");if(o<=0)throw new i.aM("scale","Scale must be greater than zero.");var c=(0,m.M6)(n);let u,b;if(c&&(b=this.getAuthenticationToken(c.portalUrl),u=(0,m.i6)(c,b)),!c||!c.itemId)throw Error(`Unable to get item ID for print template '${n}.`);if(!u)throw Error(`Unable to get item URL for print template '${n}.`);const w=t.cancellationToken;n=await(0,m.uT)(u,a,w);const g=a.create();let h;w.finally((function(){g.cancel()})),a=(0,p.qQ)(n.url,"printing"),b&&"public"!==n.access&&(h=await(0,p.Yi)(a,c.portalUrl,b,g));const f=[];if(e.parameters)for(const t of Object.keys(e.parameters)){var d,v=e.parameters[t];v&&(d=v instanceof Array,f.push({name:t,containsMultipleValues:d,value:d?void 0:v,values:d?v:void 0}))}if((n=await(0,p.cL)(c,a,h,g,w))&&n.length&&(n[0],(t=await this.getWebmapParameters(r,n[0],o,e.extent,t.ambient.trivia))&&t.length))for(const e of t)f.push(e);return s={template:{itemId:c.itemId,portalUrl:c.portalUrl,title:s},parameters:f},s=(await(0,p.uu)(a,h,s,g)).response.ticket,{href:await(0,p.bE)(a,h,s,1e3,g,w)}}getAuthenticationToken(e){return(0,m.Ni)(e)}async getWebmapParameters(e,t,a,r,n){const o=e.create();if(await o.load(),!o.map)throw new i.ls("No map available. Unable to generate webmap parameters.");return e=a||o.getScale(),r=r||o.getExtent(),n=await this.getWebmap(o,e,n),r=await this.getWgs84Extent(r),this.prepareWebmapParameters(t,n,a||0,r)}async getWebmap(e,t,a){throw console.warn("getWebmap needs to be overridden by a client implementation."),new i.qN(r.action)}async getWgs84Extent(e){throw console.warn("getWgs84Extent needs to be overridden by a client implementation."),new i.qN(r.action)}prepareWebmapParameters(e,t,a,n){throw console.warn("prepareWebmapParameters needs to be overriden by a client implementation."),new i.qN(r.action)}};u.action="gcx:wf:geocortex::RunPrint",u.suite="gcx:wf:builtin",u=r=(0,n.gn)([(0,o.hu)(s.m,c.I)],u)}}]);
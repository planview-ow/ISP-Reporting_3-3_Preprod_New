"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[6106],{6106:(e,t,n)=>{n.r(t),n.d(t,{WebRequest:()=>b});var r=n(68230),o=n(56655),s=n(8558),u=n(18886),a=n(37143),c=n.n(a),l=n(14450),i=n(40266);function f(e){return null==e?"":"boolean"==typeof e?!0===e?"true":"false":"number"==typeof e?encodeURIComponent(e.toString()):"string"==typeof e?encodeURIComponent(e):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):""}function p(e){const t=[];for(const r in e){var n=e[r];if(n instanceof Array)for(const e of n)t.push(r+"="+f(e));else t.push(r+"="+f(n))}return t.join("&")}let b=class{async execute(e,t,n){const r=n.create(e.channel,e.channelName);let s=r.request.url=u.U.string("url",e.url,u.U.never);r.request.headers=e.headers||{},r.timeout=u.U.number("timeout",e.timeout,6e4),r.corsWithCredentials=u.U.boolean("corsWithCredentials",e.corsWithCredentials,!1),null!=(n=e.query)&&(s=s.split("#")[0],a=p(n),s=0<=s.indexOf("?")?s+"&"+a:s+"?"+a,r.request.url=s);var a=e.method;r.request.method="string"==typeof a?a:"GET";let l=e.blob;l instanceof Blob&&(l=await l.arrayBuffer()),l instanceof ArrayBuffer&&(r.request.content=l),"string"==typeof(a=e.text)&&(r.request.content=a),void 0!==(a=e.json)&&(r.request.json=a),null!=(a=e.form)&&(Object.values(a).some((e=>e instanceof Blob))?r.request.content=(0,i.x)(a):r.request.content=p(a)),"blob"===e.expect&&(r.binary=!0),t.cancellationToken.finally((function(){r.cancel()}));const f=(new Date).valueOf();return r.send().then((function(t){return c().attempt((function(){const n={channel:r,elapsed:(new Date).valueOf()-f};var s=r.response.content;if("string"==typeof s&&(n.text=s,"json"===e.expect&&(t||function(e){const t=e.response.headers["Content-Type"];return"string"==typeof t&&"application/json"===t.split(";")[0].trim()}(r))&&(n.json=JSON.parse(s))),s instanceof ArrayBuffer&&(n.blob=s),null!=(s=r.response.payload)&&(n.json=s),t)return n;const u=new o.ls("WF0014","Cannot perform web request.");return u.timedOut=n.elapsed>=r.timeout,u.elapsed=n.elapsed,u.error=r.response.error,u.partialResult=n,c().reject(u)}))}))}};b.action="gcx:wf:core:request:WebRequest",b.suite="gcx:wf:builtin",b=(0,r.gn)([(0,s.QZ)(l.m)],b)}}]);